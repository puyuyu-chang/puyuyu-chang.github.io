<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ğŸ¥ºãƒã‚¦ãƒ³ãƒ‰ï¼ˆCanvasç‰ˆï¼‰</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background: #ffffdd;
    }
    canvas {
      border: 5px solid black;
      image-rendering: pixelated;
    }
  </style>
</head>
<body>
  <canvas id="game" width="400" height="400"></canvas>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    let x = 200; // çµµæ–‡å­—ã®ä½ç½®ï¼ˆä¸­å¿ƒï¼‰
    let y = 200;
    let dx = 0;
    let dy = 0;
    let lastAngle = null;

    const emoji = "ğŸ¥º";
    const fontSize = 80; // çµµæ–‡å­—ã‚µã‚¤ã‚º
    ctx.font = fontSize + "px serif";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";

    function newDirection() {
      let angle;
      do {
        angle = Math.random() * 2 * Math.PI;
      } while (
        lastAngle !== null &&
        Math.abs(Math.atan2(Math.sin(angle - lastAngle), Math.cos(angle - lastAngle))) < (Math.PI / 6)
      );
      lastAngle = angle;
      return angle;
    }

    canvas.addEventListener("click", () => {
      const angle = newDirection();
      const speed = 2.0; // é…ã‚ã«
      dx = Math.cos(angle) * speed;
      dy = Math.sin(angle) * speed;
    });

    function update() {
      x += dx;
      y += dy;

      // æ ã®ã‚µã‚¤ã‚ºã‚’è€ƒæ…®
      const padding = fontSize / 2;
      if (x <= padding || x >= canvas.width - padding) {
        dx = -dx;
        x = Math.max(padding, Math.min(x, canvas.width - padding));
      }
      if (y <= padding || y >= canvas.height - padding) {
        dy = -dy;
        y = Math.max(padding, Math.min(y, canvas.height - padding));
      }

      // æç”»ã‚¯ãƒªã‚¢
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // ğŸ¥ºã‚’æç”»
      ctx.font = fontSize + "px serif";
      ctx.fillText(emoji, x, y);

      requestAnimationFrame(update);
    }

    update();
  </script>
</body>
</html>
